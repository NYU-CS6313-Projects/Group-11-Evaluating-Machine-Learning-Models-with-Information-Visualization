<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="static/stylesheets/pygment_trac.css" media="screen">
        <link rel="stylesheet" type="text/css" href="static/stylesheets/print.css" media="print">
        <link rel="stylesheet" type="text/css" href="static/stylesheets/stylesheet.css" media="screen">
        <script type="text/javascript" src="static/javascripts/d3.v3.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <style type="text/css">

            rect:hover {
                fill: orange;
            }

            #tooltip {
                position: absolute;
                width: 200px;
                height: auto;
                padding: 10px;
                background-color: white;
                -webkit-border-radius: 10px;
                -moz-border-radius: 10px;
                border-radius: 10px;
                -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
                -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
                box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
                pointer-events: none;
            }

            #tooltip.hidden {
                display: none;
            }

            #tooltip p {
                margin: 0;
                font-family: sans-serif;
                font-size: 16px;
                line-height: 20px;
            }

            .axis {
              font: 10px sans-serif;
            }

            .axis path,
            .axis line {
              fill: none;
              stroke: #000;
              shape-rendering: crispEdges;
            }

            .x.axis path {
              display: none;
            }

        </style>
        <!--[if lt IE 9]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <title>InfoVis_11</title>
    </head>
    <body>
        <header>
            <div class="inner">
                <h1>VisML</h1>
                <h2>InfoVis serving machine learning modelling</h2>
                <a href="https://github.com/NYU-CS6313-Projects/sp2015-group11" class="button"><small>View project on</small> GitHub</a>
            </div>
        </header>
        <div id="content-wrapper">
            <div class="inner clearfix">
                <section id="main-content">
                    <div id="tooltip" class="hidden">
                        <p><strong>Important Label Heading</strong></p>
                        <p><span id="value">100</span>%</p>
                    </div>
  <!--                   <script type="text/javascript" src="static/javascripts/bar.js"></script>
                    <hr />
                    <div id="tooltip" class="hidden">
                        <p><strong>Important Label Heading</strong></p>
                        <p><span id="value">100</span>%</p>
                    </div> -->

                    <script type="text/javascript">
                        var margin = {top: 20, right: 20, bottom: 100, left: 100},
                         w = 600 - margin.left - margin.right,
                         h = 250 - margin.top - margin.bottom;
                        var barPadding = 3;

                        var dataset = []; //Initialize empty array

                        //Importing and converting error counts to numerics:
                        d3.csv("data/DummyErrorMatrix.csv", 
                          function(error,rows) {
                            rows.forEach(function(r) {
                                dataset.push({
                                    name: r.Feature,
                                    values: [r['0_TP'] = +r['0_TP'], r['1_TP']=+r['1_TP'], r['0_FP']=+r['0_FP'],
                                            r['1_FP']=+r['1_FP'],r['0_TN']=+r['0_TN'],r['1_TN']=+r['1_TN'],
                                            r['0_FN']=+r['0_FN'],r['1_FN']=+r['1_FN']]
                                })
                            console.log(dataset);
                            });
                            dataset.forEach(function(d){
                              render(d);
                            });
                        });

                        var xScale = d3.scale.ordinal()
                                        .domain(d3.range(dataset.length))
                                        .rangeRoundBands([0, w], 0.35);

                        var yScale = d3.scale.linear()
                                        .domain([0, d3.max(dataset)])
                                        .range([0, h-30]);

                        var xLabel = d3.scale.ordinal()
                                        .domain(['0-TP',
                                                '1-TP',
                                                '0-FP',
                                                '1-FP',
                                                '0-TN',
                                                '1-TN',
                                                '0-FN',
                                                '1-FN'])
                                        .rangeRoundBands([0, w], 0.35);

                        var yLabel = d3.scale.ordinal()
                                        .domain(['Feature Name'])
                                        .rangeRoundBands([0, h], 0.35);

                        var xAxis = d3.svg.axis()
                          .scale(xLabel)
                          .orient("bottom");

                        var yAxis = d3.svg.axis()
                            .scale(yScale)
                            .orient("left");

                        function render(dataset) {
                            //Create SVG element
                            var svg = d3.select("body")
                                        .append("svg")
                                        .attr("width", w + margin.left + margin.right)
                                        .attr("height", h + margin.top + margin.bottom)
                                        .append("g")
                                        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");;

                            //Create bars
                            svg.selectAll("rect")
                               .data(dataset.values)
                               .enter()
                               .append("rect")
                               .attr("x", function(d, i) {
                                       return i*(w/dataset.values.length);
                               })
                               .attr("y", function(d) {
                                       return parseInt(h - d);
                               })
                               .attr("width", (w/dataset.values.length)-barPadding)
                               .attr("height", function(d) {
                                       return parseInt(d);
                               })
                               .attr("fill", function(d) {
                                    return "rgb(0, 200, " + (d * 10) + ")";
                               })
                               .on("mouseover", function(d) {

                                    //Get this bar's x/y values, then augment for the tooltip
                                    var xPosition = parseFloat(d3.select(this).attr("x")) + xScale.rangeBand() / 2;
                                    var yPosition = parseFloat(d3.select(this).attr("y")) / 2 + h / 2;

                                    //Update the tooltip position and value
                                    d3.select("#tooltip")
                                        .style("left", xPosition + "px")
                                        .style("top", yPosition + "px")
                                        .select("#value")
                                        .text(d);

                                    //Show the tooltip
                                    d3.select("#tooltip").classed("hidden", false);

                               })
                               .on("mouseout", function() {

                                    //Hide the tooltip
                                    d3.select("#tooltip").classed("hidden", true);

                               });
                            //    .on("click", function() {
                            //            sortBars();
                            //    });

                            //Create X axis
                            svg.append("g")
                                .attr("class", "axis")
                                .attr("transform", "translate(0," + h + ")")
                                .call(xAxis);
                            //Create Y axis
                            //svg.append("g")
                            //    .attr("class", "axis")
                            //    .call(yAxis);

                            svg.append("text")
                                  .attr("transform", "rotate(0)")
                                  .attr("x",50)
                                  .attr("y", -20)
                                  .attr("dy", "1em")
                                  .style("text-anchor", "end")
                                  .style("font-size","14px")
                                  .text(dataset.name);


                        }
                    </script>

                    <h3><a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to VisML!</h3>
                    <p>Please interact with the app</p><pre><code>$ git clonehttps://github.com/NYU-CS6313-Projects/sp2015-group11.git <br>$ cd sp2015-group11<br>$ python -m SimpleHTTPServer 8888</code></pre>
                </section>
                <aside id="sidebar">
                    <a href="https://github.com/NYU-CS6313-Projects/sp2015-group11/zipball/master" class="button">
                        <small>Download</small>
                        .zip file
                    </a>
                    <a href="https://github.com/NYU-CS6313-Projects/sp2015-group11/tarball/master" class="button">
                        <small>Download</small>
                        .tar.gz file
                    </a>
                    <p class="repo-owner"><a href="https://github.com/NYU-CS6313-Projects/sp2015-group11"></a> App maintained by <a href="https://github.com/jsmedmar">jsmedmar</a>, <a href="https://github.com/jsmedmar">pjallen</a>.</p>
<!--                     <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p> -->
                </aside>
            </div>
        </div>
    </body>
</html>
